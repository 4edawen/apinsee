<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Authenticate to an Insee application — insee_auth • apinsee</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Authenticate to an Insee application — insee_auth" />
<meta property="og:description" content="Cette fonction permet de s'authentifier via une application créée sur
api.insee.fr : elle renvoie un jeton d'accès
valide qui peut ensuite être passé en valeur du paramètre token de
la fonction httr::config()." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">apinsee</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/InseeFrLab/apinsee/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Authenticate to an Insee application</h1>
    <small class="dont-index">Source: <a href='https://github.com/InseeFrLab/apinsee/blob/master/R/insee_auth.R'><code>R/insee_auth.R</code></a></small>
    <div class="hidden name"><code>insee_auth.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Cette fonction permet de s'authentifier via une application créée sur
<a href='https://api.insee.fr/'>api.insee.fr</a> : elle renvoie un jeton d'accès
valide qui peut ensuite être passé en valeur du paramètre <code>token</code> de
la fonction <a href='https://httr.r-lib.org/reference/config.html'>httr::config()</a>.</p>
    </div>

    <pre class="usage"><span class='fu'>insee_auth</span><span class='op'>(</span>
  new_auth <span class='op'>=</span> <span class='cn'>FALSE</span>,
  appname <span class='op'>=</span> <span class='st'>"DefaultApplication"</span>,
  key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='st'>"INSEE_APP_KEY"</span><span class='op'>)</span>,
  secret <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='st'>"INSEE_APP_SECRET"</span><span class='op'>)</span>,
  validity_period <span class='op'>=</span> <span class='fl'>86400</span>,
  api <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sirene - V3"</span>, <span class='st'>"Nomenclatures - v1"</span>, <span class='st'>"DonneesLocales - V0.1"</span>, <span class='st'>"BDM - V1"</span><span class='op'>)</span>,
  cache <span class='op'>=</span> <span class='cn'>FALSE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  insee_url <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"apinsee.url"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>new_auth</th>
      <td><p>booléen, valeur par défaut : <code>FALSE</code>. Passer <code>TRUE</code> si vous
souhaitez révoquer le jeton d'accès et vous authentifier à nouveau.</p></td>
    </tr>
    <tr>
      <th>appname</th>
      <td><p>nom de l'application.</p></td>
    </tr>
    <tr>
      <th>key, secret</th>
      <td><p>clef et secret du consommateur.</p></td>
    </tr>
    <tr>
      <th>validity_period</th>
      <td><p>entier, durée de validité du jeton d'accès en secondes.</p></td>
    </tr>
    <tr>
      <th>api</th>
      <td><p>Un vecteur de chaînes de caractères dont chaque élément comprend
le ou les noms des API accessibles par l'application. La correspondance
partielle est acceptée.</p></td>
    </tr>
    <tr>
      <th>cache</th>
      <td><p>booléen indiquant si <code>apinsee</code> doit sauvegarder les jetons
d'accès dans un fichier cache, par défaut <code>.httr-oauth</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>booléen; souhaitez-vous des messages d'information ?</p></td>
    </tr>
    <tr>
      <th>insee_url</th>
      <td><p>Adresse du site fournissant les API. Ce paramètre n'est
utile que pour un usage interne à l'Insee, voir la section "Utilisation
interne à l'Insee".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Un objet représentant un token pouvant être passé en valeur du
paramètre <code>token</code> de la fonction <a href='https://httr.r-lib.org/reference/config.html'>httr::config()</a>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Le couple clef du consommateur/secret du consommateur de l'application
devant rester secret, il est vivement recommandé de ne jamais l'inclure
dans un programme. La pratique recommandée est d'utiliser des variables
d'environnement pour stocker ces informations. La fonction <code>insee_auth()</code>
utilise deux variables d'environnement nommées <code>INSEE_APP_KEY</code> et
<code>INSEE_APP_SECRET</code>. Une fois renseignées, l'authentification s'effectue par
un simple appel à la fonction <code>insee_auth()</code>.</p>
<p>Les variables d'environnement peuvent être déclarées dans le fichier
<code><a href='https://rdrr.io/r/base/Startup.html'>.Renviron</a></code>. La modification de ce fichier peut s'effectuer
facilement grâce la fonction <a href='https://usethis.r-lib.org/reference/edit.html'>usethis::edit_r_environ()</a>.</p>
    <h2 class="hasAnchor" id="utilisation-interne-l-insee"><a class="anchor" href="#utilisation-interne-l-insee"></a>Utilisation interne à l'Insee</h2>

    

<p>Dans le cas d'utilisation standard, la valeur de l'option <code>apinsee.url</code> est
<code>"https://api.insee.fr/"</code>. Il n'est pas utile de la modifier sauf pour les
agents de l'Insee qui souhaiteraient utiliser les plateformes de test, de
recette ou de pré-production. Dans ce cas, afin de rendre les programmes
portables d'un environnement à un autre.il est préférable de déclarer
l'adresse en modifiant l'option <code>apinsee.url</code> :
<code><a href='https://rdrr.io/r/base/options.html'>options(apinsee.url = "&lt;URL&gt;")</a></code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='insee_deauth.html'>insee_deauth</a>, <a href='TokenInsee.html'>TokenInsee</a>, <a href='https://httr.r-lib.org/reference/config.html'>httr::config</a>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Modify the following option to access to a different url</span>
<span class='co'># options(apinsee.url = "https://api.insee.fr/")</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/InseeFrLab/apinsee'>apinsee</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://httr.r-lib.org/'>httr</a></span><span class='op'>)</span>

<span class='co'># Set the environment variables INSEE_APP_KEY and INSEE_APP_SECRET in the .Renviron file</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nchar.html'>nzchar</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"INSEE_APP_KEY"</span>, <span class='st'>"INSEE_APP_SECRET"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># retrieve the token</span>
  <span class='va'>token</span> <span class='op'>&lt;-</span> <span class='fu'>insee_auth</span><span class='op'>(</span><span class='op'>)</span>
  <span class='co'># use the token</span>
  <span class='fu'><a href='https://httr.r-lib.org/reference/set_config.html'>set_config</a></span><span class='op'>(</span><span class='fu'><a href='https://httr.r-lib.org/reference/config.html'>config</a></span><span class='op'>(</span>token <span class='op'>=</span> <span class='va'>token</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Romain Lesur.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


